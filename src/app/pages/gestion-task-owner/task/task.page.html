<app-header title="Gestion Actividad" href="/listActivity" [isBack]="true"></app-header>
<ion-content fullscreen *ngIf="actividad">
  <ion-card>
    <ion-card-header>
      <ion-card-subtitle>Proy: {{actividad.proyect_name}}</ion-card-subtitle>
      <ion-card-subtitle>Partida: {{actividad.subpartidaname}}</ion-card-subtitle>
      <ion-card-subtitle>Act: {{actividad.taskname}} - {{actividad.idActivity}} | Progreso: {{actividad.qty_tot_ejec}}
        / {{actividad.qty_ejecutar}} | UOM: {{actividad.uom}}</ion-card-subtitle>
      <ion-card-subtitle>Cant: {{actividad.cantidad}}</ion-card-subtitle>
    </ion-card-header>
  </ion-card>
  <ion-card>

    <ion-card-content>
      <form [formGroup]="taskForm" (ngSubmit)="enviar()" novalidate>
        <ion-item>
          <ion-label position="fixed" style="flex: 1 1 0%;">Cant</ion-label>
          <ion-input [(ngModel)]="cantModel" [required]="flagExcep == 0"
                     type="number" style="--padding-start: 0px;text-align: right"
                     formControlName="cantCtrl"
          ></ion-input>
          <span class="error ion-padding" *ngIf="isSubmitted && errorControl.cantCtrl.errors?.required">
      Requerido
    </span>
        </ion-item>
        <ion-item>
          <ion-label>Inicio</ion-label>
          <ion-datetime value=""
                        min="2022"
                        [required]="flagExcep == 0 || !flagExcep"
                        (click)="changeI()"
                        formControlName="dateIniCtrl"
                        [(ngModel)]="dateIni"
                        displayFormat="DD/MMM/YYYY HH:mm"
                        [pickerOptions]="customPickerOptionI"
                        dayNames="true"
                        monthShortNames="Ene,Feb,Mar,Abr,May,Jun,Jul,Ago,Sep,Oct,Nov,Dic"
                        placeholder="Seleccione fecha"></ion-datetime>
          <span class="error ion-padding" *ngIf="isSubmitted && errorControl.dateIniCtrl.errors?.required">
      Requerido
    </span>
        </ion-item>
        <ion-item>
          <ion-label>Termino</ion-label>
          <ion-datetime
            [(ngModel)]="dateFin"
            [required]="flagExcep == 0"
            formControlName="dateFinCtrl"
            [disabled]="!dateIni"
            [min]="minMaxDate"
            [max]="minMaxDate"
            [pickerOptions]="customPickerOptionF"
            (click)="changeF()"
            displayFormat="DD/MMM/YYYY HH:mm"
            monthShortNames="Ene,Feb,Mar,Abr,May,Jun,Jul,Ago,Sep,Oct,Nov,Dic"
            placeholder="Seleccione fecha"></ion-datetime>
          <span class="error ion-padding" *ngIf="isSubmitted && errorControl.dateFinCtrl.errors?.required">
      Requerido
    </span>
        </ion-item>
        <ion-item>
          <ion-label position="fixed" style="flex: 1 1 0%;">Pausa (min)</ion-label>
          <ion-input [(ngModel)]="pausaModel" type="number"
                     style="--padding-start: 0px;text-align: right"
                     formControlName="pausaCtrl"></ion-input>
        </ion-item>
        <ion-list>
          <ion-radio-group [(ngModel)]="flagExcep" formControlName="flagExcepCtrl"
                           [required]="">
            <ion-item>
              <ion-label [ngClass]="{'error': isSubmitted && errorControl.flagExcepCtrl.errors?.required}">Completado
              </ion-label>
              <ion-radio id="1" name="val1" value="0"></ion-radio>
            </ion-item>
            <ion-item>
              <ion-label [ngClass]="{'error': isSubmitted && errorControl.flagExcepCtrl.errors?.required}">No
                completado
              </ion-label>
              <ion-radio id="2" name="val2" value="1"></ion-radio>
            </ion-item>
          </ion-radio-group>
          <span class="error ion-padding" *ngIf="isSubmitted && errorControl.flagExcepCtrl.errors?.required">
      Selección requerida
    </span>
        </ion-list>

        <ion-item (click)="selectDotacion()">
          <ion-label>
            Confirmar Dotación
          </ion-label>
          <ion-label *ngIf="dotacion.length != 0" style="--padding-start: 0px;text-align: right">
            {{dotacion.length}}
          </ion-label>
          <ion-label *ngIf="dotacion.length === 0" class="text-muted" style="--padding-start: 0px; text-align: right">
            Seleccione
          </ion-label>
        </ion-item>

        <ion-item>
          <ion-label position="floating">Descripción</ion-label>
          <ion-textarea mode="ios" [(ngModel)]="obsExcep" formControlName="obsExcepCtrl"></ion-textarea>
        </ion-item>

        <ion-button color="success" expand="block" type="submit">
          <ion-icon slot="start" name="send-outline"></ion-icon>
          Enviar
        </ion-button>
      </form>
    </ion-card-content>
  </ion-card>
</ion-content>
